@use "../variables" as *;

/*
 * ================ Base Image Styles ================
 *
 * PHILOSOPHY:
 * Image styles must work with ANY user configuration using real values
 * from $base configuration, never assuming user design tokens exist.
 *
 * SCOPE: Image elements and figure captions
 * APPLIES TO: <img>, <figure>, <figcaption>
 * FEATURES: Responsive images, accessible alt text, figure styling
 */

@if $enable-base {
  /*
   * ================ Base Image Styling ================
   * Responsive and accessible image treatment
   */

  /*
   * 1. Images scale to container width for responsive design
   * 2. Offset `alt` text from surrounding copy for accessibility
   * 3. Remove white space below images (better than display: block)
   * 4. Prevent adaptive scaling when explicit dimensions are set
   */
  img {
    box-sizing: content-box;
    max-width: 100%; /* [1] */
    height: auto;
    font-style: italic; /* [2] */
    vertical-align: middle; /* [3] */
  }

  /*
   * Preserve explicit dimensions when specified
   * Prevents unwanted scaling of images with fixed sizes
   */
  img[width],
  img[height] {
    max-width: none; /* [4] */
  }

  /*
   * ================ Figure and Caption Styling ================
   * Semantic image containers with proper spacing
   */
  figure {
    margin: 3.2rem 0 4.8rem; // Double and triple base space

    /*
     * Figure image styling
     * Centered presentation within container
     */
    img {
      display: block;
      width: 100%;
      margin: 0 auto;
    }

    /*
     * Figure caption styling
     * Subtle, italicized description text
     */
    figcaption {
      margin-top: 0.4rem; // Quarter base space
      font-size: 0.851rem; // Small1 scale position (-1)
      font-style: italic;
      color: $body-text-color;
      text-align: center;
      line-height: 1.4; // Comfortable reading for captions
    }
  }

  /*
   * ================ Google Maps Compatibility ================
   * Fix for Google Maps API image styling conflicts
   */

  /*
   * Google Maps breaks with max-width: 100%
   * Use their specific selector to avoid this issue
   */
  .gm-style img {
    max-width: none;
  }

  /*
   * ================ Image Loading States ================
   * Enhanced user experience during image loading
   */

  /*
   * Loading state styling
   * Placeholder appearance while images load
   */
  img[loading="lazy"] {
    opacity: 0;
    transition: opacity 0.3s ease-in-out;

    &.loaded {
      opacity: 1;
    }
  }

  /*
   * ================ Image Accessibility Enhancements ================
   * Better support for screen readers and alt text
   */

  /*
   * Decorative images
   * Hide from screen readers when alt is empty
   */
  img[alt=""] {
    role: presentation;
  }

  /*
   * Image error state
   * Graceful degradation when images fail to load
   */
  img[src=""],
  img:not([src]) {
    opacity: 0;
  }

  /*
   * ================ Responsive Image Containers ================
   * Aspect ratio preservation for consistent layouts
   */

  /*
   * Aspect ratio container utility
   * Maintains proportions during responsive scaling
   */
  .image-container {
    position: relative;
    overflow: hidden;

    img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  }

  /*
   * Common aspect ratios
   * Pre-defined containers for standard image proportions
   */
  .image-container--16-9 {
    aspect-ratio: 16 / 9;
  }

  .image-container--4-3 {
    aspect-ratio: 4 / 3;
  }

  .image-container--1-1 {
    aspect-ratio: 1 / 1;
  }
}
